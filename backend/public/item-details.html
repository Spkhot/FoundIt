<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Item Details | FoundIt Hub</title>
    <link rel="icon" href="logo.png"/>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Poppins', sans-serif;
    }

    /* Background Animation */
    @keyframes backgroundPan {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .animated-gradient {
      background: linear-gradient(135deg, #6B21A8, #3B82F6, #EC4899, #F59E0B);
      background-size: 400% 400%;
      animation: backgroundPan 15s ease infinite;
    }

    /* Content and Card Animations */
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .animate-fadeInUp {
      animation: fadeInUp 0.6s ease-out forwards;
      opacity: 0; /* Start hidden */
    }
    .delay-1 { animation-delay: 0.1s; }
    .delay-2 { animation-delay: 0.2s; }
    .delay-3 { animation-delay: 0.3s; }
    .delay-4 { animation-delay: 0.4s; }
    .delay-5 { animation-delay: 0.5s; }
  </style>
</head>
<body class="bg-slate-900 text-white">

  <!-- Animated Background -->
  <div class="animated-gradient fixed top-0 left-0 w-full h-full z-0"></div>

  <!-- Content Wrapper -->
  <div class="relative z-10 min-h-screen flex flex-col">
    <!-- HEADER -->
    <header class="bg-black/20 backdrop-blur-lg border-b border-white/10 sticky top-0 z-50">
      <nav class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
        <a href="index.html" class="text-2xl font-bold tracking-wider hover:text-cyan-300 transition-colors">
          <span class="text-cyan-400">FoundIt</span> Hub
        </a>
        <a href="index.html" class="bg-white/90 text-slate-900 font-semibold py-2 px-5 rounded-full hover:bg-cyan-300 transition-all duration-300 shadow-lg transform hover:scale-105">
          Home
        </a>
      </nav>
    </header>

    <!-- MAIN CONTENT -->
    <main class="w-full flex-grow flex items-center justify-center p-4 md:p-6">
      <div id="main-content-wrapper" class="w-full max-w-4xl opacity-0 animate-fadeInUp">
        
        <!-- Item Details Card -->
        <div class="bg-slate-800/50 backdrop-blur-lg border border-white/10 rounded-xl shadow-2xl overflow-hidden">
          <div id="itemDetailsContainer" class="p-6 md:p-8">
              <!-- Loading State -->
              <div id="loading" class="text-center py-10">
                <p class="text-slate-300 text-lg">Loading Item Details...</p>
              </div>
          </div>
        </div>

        <!-- How to Claim Section -->
        <div id="claim-section" class="hidden mt-8 bg-black/20 backdrop-blur-lg border border-white/10 rounded-xl p-6 md:p-8 animate-fadeInUp delay-2">
            <h2 class="text-2xl font-bold text-cyan-300 mb-4 flex items-center gap-3">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd" /></svg>
                Is This Your Item? Here's What To Do.
            </h2>
            <ol class="list-decimal list-inside space-y-3 text-slate-300">
                <li><strong>Verify the Details:</strong> Carefully review the description and image. Make sure it perfectly matches your lost item.</li>
                <li><strong>Use the Contact Info:</strong> Reach out to the person who found the item using the contact details provided above. Be polite and clear.</li>
                <li><strong>Arrange a Safe Meeting:</strong> If you need to meet, choose a public, well-lit place like a coffee shop or a police station lobby. Never go to a private residence.</li>
                <li><strong>Be Ready to Prove Ownership:</strong> The finder may ask for proof. Be prepared to describe a unique feature, show a photo of you with the item, or provide a serial number if applicable.</li>
            </ol>
        </div>

        <!-- Action Buttons -->
        <div class="text-center mt-8 flex flex-wrap justify-center gap-4 animate-fadeInUp delay-4">
          <button onclick="history.back()" class="bg-white/10 border border-white/20 text-white font-semibold py-2 px-6 rounded-full transition-all transform hover:scale-105 hover:bg-white/20 duration-300">
            ← Back
          </button>
          <button onclick="deleteItem()" class="bg-red-600/80 border border-red-500/50 hover:bg-red-600 text-white font-semibold py-2 px-6 rounded-full transition-all transform hover:scale-105 duration-300 flex items-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm4 0a1 1 0 012 0v6a1 1 0 11-2 0V8z" clip-rule="evenodd" /></svg>
            Delete Item
          </button>
        </div>

      </div>
    </main>
  </div>

 <script>
  const BASE_URL =
    location.hostname === "localhost"
      ? "http://localhost:5000"
      : "https://foundit-imky.onrender.com"; // ✅ your live backend

  const itemDetailsContainer = document.getElementById('itemDetailsContainer');
  const loading = document.getElementById('loading');
  const claimSection = document.getElementById('claim-section');

  const params = new URLSearchParams(window.location.search);
  const itemId = params.get('id');

  async function fetchItemDetails(id) {
    try {
      const res = await fetch(`${BASE_URL}/api/items/${id}`);
      const item = await res.json();

      if (!res.ok) {
        loading.innerHTML = `<p class="text-red-400 text-center">Item not found or has been removed.</p>`;
        return;
      }

      loading.style.display = 'none';
      claimSection.style.display = 'block';
      document.getElementById('main-content-wrapper').style.opacity = 1;

      itemDetailsContainer.innerHTML = `
        <div class="flex flex-col md:flex-row gap-6 md:gap-8">
          <div class="md:w-2/5 animate-fadeInUp">
            <img src="${BASE_URL}/uploads/${item.image}" alt="Image of ${item.productName}" class="w-full h-auto object-cover rounded-lg shadow-lg border-2 border-white/10" />
          </div>
          <div class="md:w-3/5 flex flex-col space-y-4">
            <h1 class="text-3xl md:text-4xl font-extrabold text-cyan-300 animate-fadeInUp delay-1">${item.productName}</h1>
            <div class="space-y-3 text-slate-200 text-lg animate-fadeInUp delay-2">
                <p><strong class="text-slate-400 font-semibold w-28 inline-block">Category:</strong> ${item.category}</p>
                <p><strong class="text-slate-400 font-semibold w-28 inline-block">Found At:</strong> ${item.location}</p>
            </div>
            <div class="text-slate-300 animate-fadeInUp delay-3">
                <strong class="text-slate-400 font-semibold block mb-1">Description:</strong>
                <p>${item.description}</p>
            </div>
            <div class="mt-4 p-4 bg-slate-900/70 border border-slate-700 rounded-lg animate-fadeInUp delay-4">
                <strong class="text-slate-400 font-semibold block">Contact to Claim:</strong>
                <p class="text-xl font-bold text-white">${item.contact}</p>
            </div>
            <p class="text-xs text-slate-500 pt-3 animate-fadeInUp delay-5">Posted on ${new Date(item.createdAt).toLocaleString()}</p>
          </div>
        </div>
      `;
    } catch (error) {
      console.error(error);
      loading.innerHTML = `<p class="text-red-400 text-center">Failed to load item details. Please try again later.</p>`;
    }
  }

  async function deleteItem() {
    const confirmDelete = confirm("Are you sure you want to permanently delete this item listing? This action cannot be undone.");
    if (!confirmDelete || !itemId) return;

    try {
      const res = await fetch(`${BASE_URL}/api/items/${itemId}`, {
        method: 'DELETE',
      });

      if (res.ok) {
        alert("Item deleted successfully!");
        window.location.href = "find.html";
      } else {
        const errorData = await res.json();
        alert(`Failed to delete item: ${errorData.message || 'Unknown error'}`);
      }
    } catch (err) {
      console.error("Deletion error:", err);
      alert("A server error occurred. Could not delete the item.");
    }
  }

  if (itemId) {
    fetchItemDetails(itemId);
  } else {
    loading.innerHTML = `<p class="text-red-400 text-center">Invalid or missing item ID.</p>`;
  }
</script>

</body>
</html>